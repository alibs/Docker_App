# waf/modsecurity-override.conf (this is a template; no env vars needed)

# Ensure blocking mode (in case defaults change)
SecRuleEngine On

# Fix unicode map path (absolute path so ModSecurity can find it)
SecUnicodeMapFile /etc/nginx/modsecurity.d/unicode.mapping 20127

# Optional tuning (uncomment as needed):
# SecAuditEngine RelevantOnly
# SecAuditLog /var/log/modsec_audit.log

# Example: slightly lower inbound threshold (more aggressive blocking)
# SecAction "id:900110,phase:1,pass,nolog,setvar:tx.inbound_anomaly_score_threshold=4"

# Example: raise paranoia level
# SecAction "id:900000,phase:1,pass,nolog,setvar:tx.paranoia_level=2"